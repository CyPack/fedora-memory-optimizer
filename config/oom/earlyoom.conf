# Fedora Memory Optimizer - earlyoom Configuration
# ================================================
#
# earlyoom provides userspace OOM killing BEFORE kernel OOM
# This is a BACKUP system - primary protection comes from oom-protection-daemon
#
# Strategy:
#   - Wait until swap is 90% full before acting
#   - Kill browsers FIRST (--prefer)
#   - NEVER kill system components or IDEs (--avoid)
#
# Reference: https://github.com/rfjakob/earlyoom
#
# Generated by: Fedora Memory Optimizer v1.0.0

EARLYOOM_ARGS="\
-r 60 \
-m 5 \
-s 90 \
--prefer '^(firefox|firefox-esr|chrome|chromium|google-chrome|brave|brave-browser|opera|vivaldi|microsoft-edge|epiphany|midori|WebKitWebProcess|slack|Slack|discord|Discord|teams|zoom|skypeforlinux|telegram-desktop|signal-desktop|element-desktop)$' \
--avoid '^(gnome-shell|mutter|gsd-.*|gnome-session.*|gnome-keyring.*|Xorg|Xwayland|gdm.*|pipewire|pipewire-pulse|wireplumber|pulseaudio|systemd|dbus-daemon|dbus-broker|polkitd|NetworkManager|bluetoothd|code|code-insiders|vscodium|idea.*|pycharm.*|webstorm.*|goland.*|clion.*|sublime_text|vim|nvim|emacs.*|gnome-terminal.*|alacritty|kitty|tilix|nautilus|dolphin)$' \
-n \
"

# Explanation of flags:
# -r 60                  : Report memory status every 60 seconds
# -m 5                   : Trigger when available memory < 5%
# -s 90                  : Trigger when swap usage > 90%
# --prefer '...'         : Kill these processes FIRST (browsers, communication apps)
# --avoid '...'          : NEVER kill these processes (system, IDEs, terminals)
# -n                     : Send SIGTERM first, SIGKILL after 1s if still running
# --avoid-oom-score-adj  : Respect oom_score_adj set by oom-protection-daemon
